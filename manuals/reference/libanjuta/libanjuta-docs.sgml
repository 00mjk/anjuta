<?xml version="1.0"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN" 
    "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">
<book id="index" xmlns:xi="http://www.w3.org/2003/XInclude">
  <bookinfo>
    <authorgroup>
      <author>
	<firstname>Naba</firstname>
	<surname>Kumar</surname>
	<authorblurb>
	  <para>
	    <email>naba@gnome.org</email>
	  </para>
	</authorblurb>
      </author>
    </authorgroup>
    <copyright>
      <year>2004</year>
      <holder>Naba Kumar</holder>
    </copyright>
    <title>Anjuta Developers Reference Manual</title>
    <abstract>
      <para>
	  	libanjuta is Anjuta IDE framework for developing Anjuta plugins.
      </para>
    </abstract>

    <legalnotice>
      <para>
		This document may be distributed subject to the terms and
        conditions set forth in the Open Publication License, v1.0 or
        later (the latest version is presently available at <ulink
        url=" http://www.opencontent.org/openpub/"
        type="http">http://www.opencontent.org/openpub/</ulink> )
      </para>
    </legalnotice>
  </bookinfo>

  <chapter>
  	<title>Anjuta Architecture</title>
	<para>
		
		<figure id="anjuta-architecture">
			<title>Architecture diagram</title>
			<mediaobject>
				<imageobject>
					<imagedata fileref="anjuta-architecture.png" format="PNG"/>
				</imageobject>
			</mediaobject>
		</figure>
	</para>
  </chapter>

  <chapter>
  	<title>Writing plugins</title>
	<para>
		
	</para>
  </chapter>
  
  <chapter>
    <title>Plugin description file</title>
	<para>
		Plugin meta-data is a <emphasis>.plugin</emphasis> file that
		contains plugin information. Every plugin should have exactly one
		meta-data file. This file is used by plugin manager to identify the
		plugin and know the details prior to activation. Because there are
		some fields which require translation, a <emphasis>.plugin.in</emphasis>
		file is written instead, from which the <emphasis>.plugin</emphasis>
		file will be derived after necessary translation.
	</para>
	<para>
		Fields used in <emphasis>.plugin.in</emphasis> file are:
		<variablelist>
			<varlistentry><term>Group name</term>
				<listitem>
					<para>
						The first group should
						always be [Anjuta Plugin]. This group contains
						plugin details and will be used by plugin manager.
					</para>
				</listitem>
			</varlistentry>
			<varlistentry><term>Location</term>
				<listitem>
					<para>
						Describes where the plugin is located. It is of the
						form <emphasis>libname:classname
						</emphasis>. libname is the shared library name without
						the 'lib' prefix and '.so' suffix.
						<emphasis>classname</emphasis> is the plugin class
						defined in the library.
					</para>
				</listitem>
			</varlistentry>
			<varlistentry><term>Interfaces</term>
				<listitem>
					<para>
						Primary interfaces implemented by the plugin.
					</para>
				</listitem>
			</varlistentry>
			<varlistentry><term>Interfaces</term>
				<listitem>
					<para>
						Comma separated list
						of all interfaces that this plugin depends on. Plugin
						implementing these interaces will be activated before
						activating this plugin. This field is optional. If
						there is no dependencies, it may not present.
					</para>
				</listitem>
			</varlistentry>
			<varlistentry><term>Icon</term>
				<listitem>
					<para>
						Icon file name in .png format.
					</para>
				</listitem>
			</varlistentry>
			<varlistentry><term>_Name</term>
				<listitem>
					<para>
						Translatable plugin name.
						Notice the '_' before the key name. It means the field
						is translatable.
					</para>
				</listitem>
			</varlistentry>
			<varlistentry><term>_Description</term>
				<listitem>
					<para>
						Brief translatable
						description. Notice the '_' before the key name. It
						means the field is translatable.
					</para>
				</listitem>
			</varlistentry>
		</variablelist>
		Here is a typical plugin meta-data file
		(anjuta-document-manager.plugin.in):

<programlisting>
[Anjuta Plugin]
Location=anjuta-editor:EditorPlugin
Interfaces=IAnjutaDocumentManager
Dependencies=IAnjutaLauncher,IAnjutaMessageManager
Icon=anjuta-document-manager.png
_Name=Document Manager
_Description=Provides document management capabilities.
</programlisting>

	</para>
	<para>
		In addition to mandatory <emphasis>[Anjuta Plugin]</emphasis> group,
		the	meta-data file can also contain other groups, which a plugin can
		read using #AnjutaPluginFile methods. plugin manager simply ignores
		these additional groups, but plugins can use them on their own.
	</para>
	<para>
		A typical example would be using an extra group (e.g [Supported Mime Types])
		for a anjuta-open-file plugin to identify plugins supporting
		mime-types. It could then activate the correct plugin to open a
		particular file based on its mime-type (in addition to requiring that
		the opener plugin support a generic interface,
		such as IAnjutaStream or IAnjutaFile)
	</para>
	<para>
		To install the meta-data and icon files, add the following code in
		Makefile.am:

<programlisting>
plugin_in_files = anjuta-plugin-name.plugin.in
%.plugin: %.plugin.in $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*po) ; \
	$(INTLTOOL_MERGE) $(top_srcdir)/po $&lt; $@ -d -u \ \
		-c $(top_builddir)/po/.intltool-merge-cache

anjuta_plugindir = $(libdir)/anjuta
anjuta_plugin_DATA = $(plugin_in_files:.plugin.in=.plugin)

plugin_icondir = $(datadir)/pixmaps/anjuta
plugin_icon_DATA = anjuta-plugin-name.png
</programlisting>

		<note>
			<para>
				The $(datadir) variable should exactly match with installed
				Anjuta's datadir. In case it is different, use the command
				"pkg-config --variable=prefix libanjuta" in configure.in
				to determine the installed prefix of Anjuta.
			</para>
		</note>
	</para>
  </chapter>
  
  <chapter>
    <title>libanjuta API</title>
    <xi:include href="xml/anjuta-plugin.xml"/>
    <xi:include href="xml/anjuta-shell.xml"/>
    <xi:include href="xml/anjuta-preferences.xml"/>
    <xi:include href="xml/anjuta-preferences-dialog.xml"/>
    <xi:include href="xml/anjuta-ui.xml"/>
    <xi:include href="xml/anjuta-marshal.xml"/>
    <xi:include href="xml/properties.xml"/>
    <xi:include href="xml/resources.xml"/>
    <xi:include href="xml/anjuta-utils.xml"/>
    <xi:include href="xml/plugins.xml"/>
    <xi:include href="xml/anjuta-plugin-parser.xml"/>
    <xi:include href="xml/anjuta-children.xml"/>
    <xi:include href="xml/anjuta-encodings.xml"/>
    <xi:include href="xml/anjuta-stock.xml"/>
  </chapter>
  
  <chapter>
    <title>libanjuta internal API</title>
    <xi:include href="xml/glue-factory.xml"/>
    <xi:include href="xml/glue-plugin.xml"/>
    <xi:include href="xml/gnomefilelist.xml"/>
    <xi:include href="xml/e-splash.xml"/>
    <xi:include href="xml/cell-renderer-captioned-image.xml"/>
    <xi:include href="xml/defaults.xml"/>
    <xi:include href="xml/pixmaps.xml"/>
    <xi:include href="xml/fileselection.xml"/>
  </chapter>
  <chapter>
    <title>Plugin interfaces</title>
    <xi:include href="xml/ianjuta-editor.xml"/>
    <xi:include href="xml/ianjuta-document-manager.xml"/>
    <xi:include href="xml/ianjuta-message-view.xml"/>
    <xi:include href="xml/ianjuta-message-manager.xml"/>
  </chapter>
  <chapter>
    <title>Object Hierarchy</title>
    <xi:include href="xml/tree_index.sgml"/>
  </chapter>
</book>
