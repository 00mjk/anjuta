AT_SETUP([Set node properties])
AS_MKDIR_P([empty])
AT_DATA([empty/configure.ac],
[[AC_CONFIG_FILES(Makefile)
]])
AT_DATA([empty/Makefile.am],
[[
bin_PROGRAMS = target1
]])



AT_DATA([expect],
[[    GROUP (0): empty1
        TARGET (0:0): target1
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GDL_LIBS)
]])
AT_DATA([reference.am],
[[
bin_PROGRAMS = target1

target1_LDADD = $(GDL_LIBS)
]])
AT_PARSER_CHECK([load empty \
		move empty1 \
		set 0:0 lib '$(GDL_LIBS)' \
		list \
		save])
AT_CHECK([diff -b empty1/Makefile.am reference.am])
AT_PARSER_CHECK([load empty1 \
		 list])
AT_CHECK([diff output expect])



AT_DATA([expect],
[[    GROUP (0): empty2
        TARGET (0:0): target1
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GDL_LIBS) $(GLIB_LIBS)
]])
AT_DATA([reference.am],
[[
bin_PROGRAMS = target1

target1_LDADD = $(GDL_LIBS) \
	$(GLIB_LIBS)
]])
AT_PARSER_CHECK([load empty1 \
		move empty2 \
		set 0:0 lib '$(GDL_LIBS) $(GLIB_LIBS)' \
		list \
		save])
AT_CHECK([diff -b empty2/Makefile.am reference.am])
AT_PARSER_CHECK([load empty2 \
		 list])
AT_CHECK([diff output expect])



AT_DATA([expect],
[[    GROUP (0): empty3
        TARGET (0:0): target1
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GLIB_LIBS)
]])
AT_DATA([reference.am],
[[
bin_PROGRAMS = target1

target1_LDADD = $(GLIB_LIBS)
]])
AT_PARSER_CHECK([load empty2 \
		move empty3 \
		set 0:0 lib '$(GLIB_LIBS)' \
		list \
		save])
AT_CHECK([diff -b empty3/Makefile.am reference.am])
AT_PARSER_CHECK([load empty3 \
		 list])
AT_CHECK([diff output expect])



AT_DATA([expect],
[[    GROUP (0): empty4
        TARGET (0:0): target1
            PROPERTY (Installation directory): bindir
]])
AT_DATA([reference.am],
[[
bin_PROGRAMS = target1
]])
AT_PARSER_CHECK([load empty3 \
		move empty4 \
		clear 0:0 lib \
		list \
		save])
AT_CHECK([diff -b empty4/Makefile.am reference.am])
AT_PARSER_CHECK([load empty4 \
		 list])
AT_CHECK([diff output expect])



AT_DATA([expect],
[[    GROUP (0): empty5
        TARGET (0:0): target1
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GDL_LIBS)
        TARGET (0:1): target2
            PROPERTY (Installation directory): bindir
]])
AT_DATA([reference.am],
[[
bin_PROGRAMS = target1 \
	target2

target1_LDADD = $(GDL_LIBS)
]])
AT_PARSER_CHECK([load empty4 \
		move empty5 \
		set 0:0 lib '$(GDL_LIBS)' \
		add target 0 target2 prog \
		list \
		save])
AT_CHECK([diff -b empty5/Makefile.am reference.am])
AT_PARSER_CHECK([load empty5 \
		 list])
AT_CHECK([diff output expect])



AT_DATA([expect],
[[    GROUP (0): empty6
        TARGET (0:0): target1
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GDL_LIBS)
        TARGET (0:1): target2
            PROPERTY (Installation directory): bindir
            SOURCE (0:1:0): source1
]])
AT_DATA([reference.am],
[[
bin_PROGRAMS = target1 \
	target2

target1_LDADD = $(GDL_LIBS)

target2_SOURCES =  \
	source1
]])
AT_PARSER_CHECK([load empty5 \
		move empty6 \
		add source 0:1 source1 \
		list \
		save])
AT_CHECK([diff -b empty6/Makefile.am reference.am])
AT_PARSER_CHECK([load empty6 \
		 list])
AT_CHECK([diff output expect])



AT_DATA([expect],
[[    GROUP (0): empty7
        TARGET (0:0): target1
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GDL_LIBS)
        TARGET (0:1): target2
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GDL_LIBS)
            SOURCE (0:1:0): source1
]])
AT_DATA([reference.am],
[[
bin_PROGRAMS = target1 \
	target2

target1_LDADD = $(GDL_LIBS)

target2_SOURCES =  \
	source1

target2_LDADD = $(GDL_LIBS)
]])
AT_PARSER_CHECK([load empty6 \
		move empty7 \
		set 0:1 lib '$(GDL_LIBS)' \
		list \
		save])
AT_CHECK([diff -b empty7/Makefile.am reference.am])
AT_PARSER_CHECK([load empty7 \
		 list])
AT_CHECK([diff output expect])



AT_DATA([expect],
[[    GROUP (0): empty8
        TARGET (0:0): target1
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GDL_LIBS)
            SOURCE (0:0:0): source2
        TARGET (0:1): target2
            PROPERTY (Installation directory): bindir
            PROPERTY (Libraries): $(GDL_LIBS)
            SOURCE (0:1:0): source1
]])
AT_DATA([reference.am],
[[
bin_PROGRAMS = target1 \
	target2

target1_SOURCES =  \
	source2

target1_LDADD = $(GDL_LIBS)

target2_SOURCES =  \
	source1

target2_LDADD = $(GDL_LIBS)
]])
AT_PARSER_CHECK([load empty7 \
		move empty8 \
		add source 0:0 source2 \
		list \
		save])
AT_CHECK([diff -b empty8/Makefile.am reference.am])
AT_PARSER_CHECK([load empty8 \
		 list])
AT_CHECK([diff output expect])



AT_CLEANUP
